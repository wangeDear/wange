# 一阶段提交协议

开启事务后，由应用发出事务提交或者回滚，将成功失败返回给应用应用程序，应用继续执行。
一阶段提交协议相对简单，不用与其他对象交互，节省了判断步骤和时间，在性能上有绝对的优势。
缺点：
1. 数据库确认执行事务的时间越长，出现问题的可能性也会变大。
2. 如果有多个数据源，无法协调他们之间的关系。

# 二阶段提交协议

![](https://blog-1258875084.cos.ap-guangzhou.myqcloud.com//picGoImg20211130182329.png)

增加了中间管理者的角色，从而协调多个数据源之间的关系，二阶段提交协议分为两个阶段。
为什么要分两步执行？一是因为分两步，就有了事务管理器统一管理的机会；二尽可能晚地提交事务，让事务在提交前尽可能地完成所有能完成的工作，这样，最后的提交阶段将是耗时极短，耗时极短意味着操作失败的可能性也就降低。
同时，二阶段提交协议为了保证事务的一致性，不管是事务管理器还是各个资源管理器，每执行一步操作，都会记录日志，为出现故障后的恢复准备依据。
二阶段提交协议的存在的弊端是阻塞，因为事务管理器要收集各个资源管理器的响应消息，如果其中一个或多个一直不返回消息，则事务管理器一直等待，应用程序也被阻塞，甚至可能永久阻塞。

